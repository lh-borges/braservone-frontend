<!-- Filtros -->
<div class="card p-3 mb-3">
  <div class="row g-2 align-items-end">
    <div class="col-md-3">
      <label class="form-label">Início</label>
      <input class="form-control" type="date" [(ngModel)]="inicio" (change)="onPeriodoChange()">
    </div>
    <div class="col-md-3">
      <label class="form-label">Fim</label>
      <input class="form-control" type="date" [(ngModel)]="fim" (change)="onPeriodoChange()">
    </div>
    <div class="col-md-6">
      <label class="form-label">Placas (múltipla seleção; vazio = Todos)</label>
      <div class="d-flex gap-2">
        <select class="form-select" multiple size="6" style="min-width:220px" [(ngModel)]="selecionadas">
          <option *ngFor="let p of placas" [ngValue]="p">{{ p }}</option>
        </select>
        <div class="d-flex flex-column gap-2">
          <button class="btn btn-outline-secondary btn-sm" (click)="selecionarTodas()">Selecionar todas</button>
          <button class="btn btn-outline-secondary btn-sm" (click)="limparSelecao()">Limpar seleção</button>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-3 d-flex gap-2">
    <button class="btn btn-primary" (click)="carregarSerie()" [disabled]="loading">Atualizar</button>
    <button class="btn btn-outline-secondary" (click)="setUltimosDias(30)">Últimos 30 dias</button>
    <button class="btn btn-outline-secondary" (click)="setUltimosDias(90)">Últimos 90 dias</button>
    <span class="ms-auto text-muted" *ngIf="loading">Carregando…</span>
    <span class="ms-auto text-danger" *ngIf="errorMsg">{{ errorMsg }}</span>
  </div>
</div>

<!-- Grade: 18 gráficos com títulos no próprio chart -->
<div class="row g-3">
  <!-- 1 -->
  <div class="col-lg-6"><div class="card p-3" style="height:300px">
    <canvas baseChart [type]="'line'" [data]="lineCustoData" [options]="lineCustoOpts"></canvas>
  </div></div>
  <!-- 2 -->
  <div class="col-lg-6"><div class="card p-3" style="height:300px">
    <canvas baseChart [type]="'bar'" [data]="barLitrosData" [options]="barLitrosOpts"></canvas>
  </div></div>
  <!-- 3 -->
  <div class="col-lg-6"><div class="card p-3" style="height:300px">
    <canvas baseChart [type]="'bar'" [data]="barKmData" [options]="barKmOpts"></canvas>
  </div></div>
  <!-- 4 -->
  <div class="col-lg-6"><div class="card p-3" style="height:300px">
    <canvas baseChart [type]="'line'" [data]="linePrecoData" [options]="linePrecoOpts"></canvas>
  </div></div>
  <!-- 5 -->
  <div class="col-lg-6"><div class="card p-3" style="height:300px">
    <canvas baseChart [type]="'line'" [data]="lineKmLData" [options]="lineKmLOpts"></canvas>
  </div></div>
  <!-- 6 -->
  <div class="col-lg-6"><div class="card p-3" style="height:300px">
    <canvas baseChart [type]="'line'" [data]="lineRsKmData" [options]="lineRsKmOpts"></canvas>
  </div></div>
  <!-- 7 -->
  <div class="col-lg-6"><div class="card p-3" style="height:300px">
    <canvas baseChart [type]="'bar'" [data]="barQtData" [options]="barQtOpts"></canvas>
  </div></div>
  <!-- 8 -->
  <div class="col-lg-6"><div class="card p-3" style="height:300px">
    <canvas baseChart [type]="'line'" [data]="lineCustoAcData" [options]="lineCustoAcOpts"></canvas>
  </div></div>
  <!-- 9 -->
  <div class="col-lg-6"><div class="card p-3" style="height:300px">
    <canvas baseChart [type]="'line'" [data]="lineLitrosAcData" [options]="lineLitrosAcOpts"></canvas>
  </div></div>
  <!-- 10 -->
  <div class="col-lg-6"><div class="card p-3" style="height:300px">
    <canvas baseChart [type]="'line'" [data]="lineKmAcData" [options]="lineKmAcOpts"></canvas>
  </div></div>
  <!-- 11 -->
  <div class="col-lg-6"><div class="card p-3" style="height:300px">
    <canvas baseChart [type]="'line'" [data]="lineTicketData" [options]="lineTicketOpts"></canvas>
  </div></div>
  <!-- 12 -->
  <div class="col-lg-6"><div class="card p-3" style="height:300px">
    <canvas baseChart [type]="'line'" [data]="lineLitrosMedData" [options]="lineLitrosMedOpts"></canvas>
  </div></div>

  <!-- +6 comparativos por veículo -->
  <!-- 13 -->
  <div class="col-lg-6"><div class="card p-3" style="height:280px">
    <canvas baseChart [type]="'bar'" [data]="barTotCustoPorCarro" [options]="barTotCustoOpts"></canvas>
  </div></div>
  <!-- 14 -->
  <div class="col-lg-6"><div class="card p-3" style="height:280px">
    <canvas baseChart [type]="'bar'" [data]="barTotLitrosPorCarro" [options]="barTotLitrosOpts"></canvas>
  </div></div>
  <!-- 15 -->
  <div class="col-lg-6"><div class="card p-3" style="height:280px">
    <canvas baseChart [type]="'bar'" [data]="barTotKmPorCarro" [options]="barTotKmOpts"></canvas>
  </div></div>
  <!-- 16 -->
  <div class="col-lg-6"><div class="card p-3" style="height:280px">
    <canvas baseChart [type]="'bar'" [data]="barMedPrecoPorCarro" [options]="barMedPrecoOpts"></canvas>
  </div></div>
  <!-- 17 -->
  <div class="col-lg-6"><div class="card p-3" style="height:280px">
    <canvas baseChart [type]="'bar'" [data]="barMedKmLPorCarro" [options]="barMedKmLOpts"></canvas>
  </div></div>
  <!-- 18 -->
  <div class="col-lg-6"><div class="card p-3" style="height:280px">
    <canvas baseChart [type]="'bar'" [data]="barMedRsKmPorCarro" [options]="barMedRsKmOpts"></canvas>
  </div></div>
</div>
